(self.webpackChunksix_app=self.webpackChunksix_app||[]).push([[7542],{7542:(e,t,a)=>{"use strict";a.r(t),a.d(t,{six_form:()=>r});var n=a(6304),i=a(1488),s=a(3655);let r=class{constructor(e){(0,i.r)(this,e),this.sixSubmit=(0,i.c)(this,"six-form-submit",7),this.sixChange=(0,i.c)(this,"six-form-change",7),this.sixReset=(0,i.c)(this,"six-form-reset",7),this.eventListeners=new s.E,this.novalidate=!1}connectedCallback(){this.formControls=[{tag:"six-button",serialize:(e,t)=>e.name&&!e.disabled?t.append(e.name,e.value):null,click:e=>{const t=e.target;t.submit&&this.submit(),t.reset&&this.reset()}},{tag:"six-checkbox",serialize:(e,t)=>e.name&&e.checked&&!e.disabled?t.append(e.name,e.value):null,changeEventName:"six-checkbox-change"},{tag:"six-color-picker",serialize:(e,t)=>e.name&&!e.disabled?t.append(e.name,e.value):null},{tag:"six-input",serialize:(e,t)=>e.name&&!e.disabled?t.append(e.name,e.value):null,keyDown:e=>{"Enter"!==e.key||e.defaultPrevented||this.submit()},changeEventName:"six-input-change"},{tag:"six-datepicker",serialize:(e,t)=>{var a;return e.name&&!e.disabled?t.append(e.name,null===(a=e.value)||void 0===a?void 0:a.toISOString()):null},keyDown:e=>{"Enter"!==e.key||e.defaultPrevented||this.submit()},changeEventName:"six-datepicker-select"},{tag:"six-radio",serialize:(e,t)=>e.name&&e.checked&&!e.disabled?t.append(e.name,e.value):null,changeEventName:"six-radio-change"},{tag:"six-range",serialize:(e,t)=>{e.name&&!e.disabled&&t.append(e.name,e.value+"")},changeEventName:"six-range-change"},{tag:"six-select",serialize:(e,t)=>{if(e.name&&!e.disabled)if(e.multiple){const a=[...e.value];a.length?a.map(a=>t.append(e.name,a)):t.append(e.name,"")}else t.append(e.name,e.value+"")},changeEventName:"six-select-change"},{tag:"six-switch",serialize:(e,t)=>e.name&&e.checked&&!e.disabled?t.append(e.name,e.value):null,changeEventName:"six-switch-change"},{tag:"six-textarea",serialize:(e,t)=>e.name&&!e.disabled?t.append(e.name,e.value):null,changeEventName:"six-textarea-change"},{tag:"six-timepicker",serialize:(e,t)=>e.name&&!e.disabled?t.append(e.name,e.value):null,keyDown:e=>{"Enter"!==e.key||e.defaultPrevented||this.submit()},changeEventName:"six-timepicker-change"}],this.handleClick=this.handleClick.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}disconnectedCallback(){this.eventListeners.removeAll()}componentDidLoad(){this.getFormControls().then(e=>e.forEach(e=>this.appendChangeListener(e)))}appendChangeListener(e){const t=e.tagName.toLowerCase();for(const a of this.formControls)a.tag===t&&a.changeEventName&&this.eventListeners.add(e,a.changeEventName,()=>this.handleChange(e))}getFormData(){var e=this;return(0,n.Z)(function*(){const t=new FormData;return(yield e.getFormControls()).map(a=>e.serializeElement(a,t)),t})()}getFormControls(){var e=this;return(0,n.Z)(function*(){const t=e.form.querySelector("slot"),a=e.formControls.map(e=>e.tag);return t.assignedElements({flatten:!0}).reduce((e,t)=>e.concat(t,[...t.querySelectorAll("*")]),[]).filter(e=>a.includes(e.tagName.toLowerCase()))})()}submit(){var e=this;return(0,n.Z)(function*(){const t=yield e.getFormData(),a=yield e.getFormControls(),n=a.filter(e=>"function"==typeof e.reportValidity);if(!e.novalidate){let e=!0;for(const t of n)(yield t.reportValidity())||(e=!1);if(!e)return!1}return e.sixSubmit.emit({formData:t,formControls:a}),!0})()}checkValidity(){var e=this;return(0,n.Z)(function*(){const t=(yield e.getFormControls()).filter(e=>"function"==typeof e.checkValidity).map(e=>e.checkValidity());return 0==(yield Promise.all(t).then(e=>e.filter(e=>!1===e))).length})()}reset(){var e=this;return(0,n.Z)(function*(){(yield e.getFormControls()).filter(e=>(null==e?void 0:e.reset)&&"function"==typeof(null==e?void 0:e.reset)).forEach(e=>e.reset()),e.sixReset.emit()})()}handleClick(e){const t=e.target.tagName.toLowerCase();for(const a of this.formControls)a.tag===t&&a.click&&a.click(e)}handleKeyDown(e){const t=e.target.tagName.toLowerCase();for(const a of this.formControls)a.tag===t&&a.keyDown&&a.keyDown(e)}handleChange(e){this.checkValidity().then(t=>this.sixChange.emit({valid:t,formControl:e}))}serializeElement(e,t){const a=e.tagName.toLowerCase();for(const n of this.formControls)if(n.tag===a)return n.serialize(e,t);return null}render(){return(0,i.h)("div",{ref:e=>this.form=e,part:"base",class:"form",role:"form",onClick:this.handleClick,onKeyDown:this.handleKeyDown},(0,i.h)("slot",null))}};r.style=":host{position:relative;box-sizing:border-box}:host *,:host *:before,:host *:after{box-sizing:inherit}:host{display:block}"}}]);